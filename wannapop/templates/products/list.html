{% extends 'layouts/_base.html' %}

{% block title %}
Productes
{% endblock %}

{% block content %}
<table class="table table-bordered table-striped" style="background-color: #fefefe;">
	<thead>
		<tr>
			<th>ID</th>
			<th>NOM</th>
			<th>PREU</th>
			<th>CATEGORIA</th>
			<th colspan="3">Accions</th>
		</tr>
	</thead>

<tbody>
    {% for (product, category) in products_with_category %}
        <tr class="{{ 'own' if product.seller_id == current_user.id }}">
            <td><a href="/products/read/{{ product.id }}" alt="Visualitzar">{{ product.id }}</a></td>
            <td>{{ product.title }}</td>
            <td>{{ product.price }}</td>
            <td>{{ category.name }}</td>
            <td>
                <a href="/products/read/{{ product.id }}" alt="Visualitzar">üëÅÔ∏è</a>
            </td>
            <td>
                {% if current_user.is_action_allowed_to_product(Action.products_update, product) %}
                    <a href="/products/update/{{ product.id }}" alt="Editar">üìù</a>
                {% endif %}
            </td>
            <td>
                {% if current_user.is_action_allowed_to_product(Action.products_delete, product) %}
                    <a href="/products/delete/{{ product.id }}" alt="Eliminar">‚ùå</a>
                {% endif %}
            </td>
            
			{% if current_user.is_action_allowed_to_product(Action.products_moderate, product) %}
			<td>
				{% if not product.banned_info %}
					<a href="/products/ban/{{ product.id }}" alt="Ban">üö´</a>
				{% endif %}
				{% if product.banned_info and current_user.is_moderator() %}
					<a href="/products/unban/{{ product.id }}" alt="Unban">üü¢</a>
				{% endif %}
			</td>
			{% endif %}
            
            
			{% if product.banned_info %}
			<td>
				<span class="badge bg-danger">Banned - {{ product.banned_info.justification }}</span>
			</td>
			{% endif %}
            
        </tr>
    {% endfor %}
</tbody>

</table>
{% if current_user.is_action_allowed_to_product(Action.products_create) %}
<a class="btn btn-secondary btn-xl" href="/products/create">Crear un nou producte</a>
{% endif %}
{% endblock %}
